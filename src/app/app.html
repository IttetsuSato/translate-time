<div class="wind-calculator">
  <div class="header">
    <h1>{{ title() }}</h1>
    <p>100mのタイムと風速を入力して、無風換算タイムと各風速でのタイムを計算します</p>
  </div>

  <div class="input-section">
    <div class="input-group">
      <label for="actualTime">実際のタイム (秒)</label>
      <input
        id="actualTime"
        type="number"
        step="0.01"
        min="0"
        [ngModel]="actualTime()"
        (ngModelChange)="actualTime.set($event)"
        placeholder="例: 10.50"
      />
    </div>
    
    <div class="input-group">
      <label for="windSpeed">風速 (m/s)</label>
      <input
        id="windSpeed"
        type="number"
        step="0.1"
        [ngModel]="windSpeed()"
        (ngModelChange)="windSpeed.set($event)"
        placeholder="例: 1.5"
      />
      <small>正の値: 向かい風、負の値: 追い風</small>
    </div>
  </div>

  @if (actualTime() > 0) {
    <div class="results-section">
      <!-- 現在の風速での結果 -->
      <div class="current-result">
        <h2>現在の風速 ({{ windSpeed() }}m/s) での結果</h2>
        <div class="result-cards">
          <div class="result-card">
            <div class="result-label">実際のタイム</div>
            <div class="result-value">{{ actualTime() }}秒</div>
          </div>
          <div class="result-card">
            <div class="result-label">調整後タイム</div>
            <div class="result-value">{{ getCurrentAdjustedTime() }}秒</div>
          </div>
          <div class="result-card" [class.advantage]="getCurrentAdvantage() < 0" [class.disadvantage]="getCurrentAdvantage() > 0">
            <div class="result-label">有利・不利</div>
            <div class="result-value">{{ getCurrentAdvantage() > 0 ? '+' : '' }}{{ getCurrentAdvantage() }}秒</div>
          </div>
        </div>
      </div>

      <!-- 無風換算タイム -->
      <div class="no-wind-result">
        <h2>無風換算タイム</h2>
        <div class="no-wind-time">{{ noWindTime().toFixed(3) }}秒</div>
      </div>

      <!-- 風速別タイム表 -->
      <div class="wind-table-section">
        <h2>風速別タイム表 (-2.0m/s ～ +2.0m/s)</h2>
        <div class="table-container">
          <table class="wind-table">
            <thead>
              <tr>
                <th>風速 (m/s)</th>
                <th>調整後タイム (秒)</th>
                <th>有利・不利 (秒)</th>
                <th>状況</th>
              </tr>
            </thead>
            <tbody>
              @for (result of windTimeTable(); track result.windSpeed) {
                <tr [class.current-wind]="result.windSpeed === windSpeed()">
                  <td class="wind-speed">{{ result.windSpeed }}</td>
                  <td class="adjusted-time">{{ result.adjustedTime }}</td>
                  <td class="advantage" 
                      [class.positive]="result.advantage > 0" 
                      [class.negative]="result.advantage < 0">
                    {{ result.advantage > 0 ? '+' : '' }}{{ result.advantage }}
                  </td>
                  <td class="situation">
                    @if (result.windSpeed > 0) {
                      <span class="headwind">向かい風</span>
                    } @else if (result.windSpeed < 0) {
                      <span class="tailwind">追い風</span>
                    } @else {
                      <span class="no-wind">無風</span>
                    }
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>
  } @else {
    <div class="no-data">
      <p>タイムを入力してください</p>
    </div>
  }
</div>

<router-outlet />
